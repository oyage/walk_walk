# TDD（テスト駆動開発）: 変更意図のテストを先に書く

**TDD（Test-Driven Development）** に則り、機能追加・バグ修正・リファクタなど**実装を変更するとき**は、まず「変更意図を表現するテスト」を書いてから実装に着手する。

## 手順

1. **テストを先に書く（Red）**  
   意図した振る舞い（新機能の成功パス・エラー時の表示・既存仕様の維持など）をテストで記述する。必要に応じてモック・スタブで外部依存を切り離す。

2. **テストが存在することを確認**  
   その時点ではテストが失敗していてよい（Red）。変更意図がテストとして存在していることを確認する。

3. **実装を変更する（Green）**  
   上記テストが通るように実装を追加・修正する。

4. **リファクタ（必要に応じて）**  
   テストが通ったまま、コードを整理する。

## テストの書き方

- 意図した振る舞いを `expect` で明確に書く（「何が起きるべきか」が読み取れるようにする）。
- 外部依存（API・DB・位置情報・TTS など）はモック・スタブで置き換え、テスト単体で完結させる。

これにより、変更意図の共有・検証とリグレッション防止がしやすくなる。
